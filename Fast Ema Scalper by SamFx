//@version=5
indicator("5 & 11 EMA Crossover Indicator", overlay=true)

// Define EMAs
ema5 = ta.ema(close, 5)
ema11 = ta.ema(close, 11)

// ATR-based SL Calculation
atrLength = 14
atrMultiplier = 1.5
atrValue = ta.atr(atrLength)

// Buy & Sell Conditions
longCondition = ta.crossover(ema5, ema11)
shortCondition = ta.crossunder(ema5, ema11)

// ATR-based Stop Loss & Take Profit
longSL = close - (atrValue * atrMultiplier)
shortSL = close + (atrValue * atrMultiplier)

// Risk-Reward Ratio (RR = 1:2)
rr_ratio = 2.0
longTP = close + ((close - longSL) * rr_ratio)
shortTP = close - ((shortSL - close) * rr_ratio)

// Volume Filter
volFilter = volume > ta.sma(volume, 10)

// Buy/Sell Signals
plotshape(series=longCondition and volFilter, location=location.belowbar, color=color.green, style=shape.labelup, title="BUY Signal", text="BUY")
plotshape(series=shortCondition and volFilter, location=location.abovebar, color=color.red, style=shape.labeldown, title="SELL Signal", text="SELL")

// Draw Trade Lines
var line longEntryLine = na
var line longSLLine = na
var line longTPLine = na
var line shortEntryLine = na
var line shortSLLine = na
var line shortTPLine = na

if longCondition and volFilter
    longEntryLine := line.new(x1=bar_index, y1=close, x2=bar_index+5, y2=close, color=color.blue, width=2, style=line.style_solid) // Entry Line
    longSLLine := line.new(x1=bar_index, y1=longSL, x2=bar_index+5, y2=longSL, color=color.red, width=2, style=line.style_dashed) // SL Line
    longTPLine := line.new(x1=bar_index, y1=longTP, x2=bar_index+5, y2=longTP, color=color.green, width=2, style=line.style_dashed) // TP Line
    alert("BUY Signal! Entry: " + str.tostring(close) + " | SL: " + str.tostring(longSL) + " | TP: " + str.tostring(longTP), alert.freq_once_per_bar_close)

if shortCondition and volFilter
    shortEntryLine := line.new(x1=bar_index, y1=close, x2=bar_index+5, y2=close, color=color.orange, width=2, style=line.style_solid) // Entry Line
    shortSLLine := line.new(x1=bar_index, y1=shortSL, x2=bar_index+5, y2=shortSL, color=color.red, width=2, style=line.style_dashed) // SL Line
    shortTPLine := line.new(x1=bar_index, y1=shortTP, x2=bar_index+5, y2=shortTP, color=color.green, width=2, style=line.style_dashed) // TP Line
    alert("SELL Signal! Entry: " + str.tostring(close) + " | SL: " + str.tostring(shortSL) + " | TP: " + str.tostring(shortTP), alert.freq_once_per_bar_close)

// Plot EMAs
plot(ema5, title="5 EMA", color=color.blue, linewidth=2)
plot(ema11, title="11 EMA", color=color.red, linewidth=2)
